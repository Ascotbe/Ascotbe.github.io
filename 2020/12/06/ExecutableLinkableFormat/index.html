<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Linux ELF格式解析 | ascotbe</title><meta name="author" content="ascotbe"><meta name="copyright" content="ascotbe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="声明  郑重声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担！  前言 在写PE结构解析的时候，以为ELF结构没必要去看文件结构，直到后面做了PWN题发现不是这样的，所有还是学习下ELF结构，然后再写个解析器  常见结构区分 目前，PC平台流行的可执行文件格式（Executable）主要包含如下两种，它们都是COFF（C">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux ELF格式解析">
<meta property="og:url" content="https://www.ascotbe.com/2020/12/06/ExecutableLinkableFormat/index.html">
<meta property="og:site_name" content="ascotbe">
<meta property="og:description" content="声明  郑重声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担！  前言 在写PE结构解析的时候，以为ELF结构没必要去看文件结构，直到后面做了PWN题发现不是这样的，所有还是学习下ELF结构，然后再写个解析器  常见结构区分 目前，PC平台流行的可执行文件格式（Executable）主要包含如下两种，它们都是COFF（C">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/119.jpg">
<meta property="article:published_time" content="2020-12-06T15:45:42.000Z">
<meta property="article:modified_time" content="2021-07-05T01:53:25.063Z">
<meta property="article:author" content="ascotbe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/119.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://www.ascotbe.com/2020/12/06/ExecutableLinkableFormat/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-05 09:53:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="ascotbe" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpeg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/Loophole"><i class="fa-fw fa fa-link"></i><span> Loophole</span></a></div><div class="menus_item"><a class="site-page" href="/Taylor%20Swift"><i class="fa-fw fa fa-link"></i><span> Taylor Swift</span></a></div><div class="menus_item"><a class="site-page" href="/Links/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.staticdn.net/Ascotbe/Random-img/master/Blog/119.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ascotbe</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/Loophole"><i class="fa-fw fa fa-link"></i><span> Loophole</span></a></div><div class="menus_item"><a class="site-page" href="/Taylor%20Swift"><i class="fa-fw fa fa-link"></i><span> Taylor Swift</span></a></div><div class="menus_item"><a class="site-page" href="/Links/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux ELF格式解析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-06T15:45:42.000Z" title="发表于 2020-12-06 23:45:42">2020-12-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-05T01:53:25.063Z" title="更新于 2021-07-05 09:53:25">2021-07-05</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>声明</p>
</blockquote>
<p>郑重声明：文中所涉及的技术、思路和工具仅供以安全为目的的学习交流使用，任何人不得将其用于非法用途以及盈利等目的，否则后果自行承担！</p>
<blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2></blockquote>
<p>在写PE结构解析的时候，以为ELF结构没必要去看文件结构，直到后面做了PWN题发现不是这样的，所有还是学习下ELF结构，然后再写个解析器</p>
<blockquote>
<h2 id="常见结构区分"><a href="#常见结构区分" class="headerlink" title="常见结构区分"></a>常见结构区分</h2></blockquote>
<p>目前，PC平台流行的可执行文件格式（Executable）主要包含如下两种，它们都是<strong>COFF</strong>（Common File Format）格式的变种</p>
<ul>
<li>Windows下的<strong>PE</strong>（Portable Executable）</li>
<li>Linux下的<strong>ELF</strong>（Executable Linkable Format）</li>
</ul>
<p><strong>源代码经过编译后但未进行连接的那些中间文件</strong>（Windows的<code>.obj</code>和Linux的<code>.o</code>），它与可执行文件的格式非常相似，所以一般跟可执行文件格式一起采用同一种格式存储。</p>
<p>其中动态链接库（<strong>DDL，Dynamic Linking Library</strong>）和静态链接库（<strong>Static Linking Library</strong>）的格式都和当前系统对应的可执行文件结构一样</p>
<ul>
<li>动态链接库：Windows的<code>.dll</code>、Linux的<code>.so</code></li>
<li>静态链接库：Windows的<code>.lib</code>、Linux的<code>.a</code></li>
</ul>
<blockquote>
<h2 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h2></blockquote>
<h3 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h3><p>ELF文件有三种类型，可以通过ELF Header中的<code>e_type</code>成员进行区分：</p>
<ul>
<li><strong>可重定位文件（Relocatable File）</strong>：<code>ETL_REL</code>。一般为<code>.o</code>文件，可以与其他目标文件链接来创建可执行文件或共享目标文件的代码和数据。静态链接库属于可重定位文件</li>
<li><strong>可执行文件（Executable File）</strong>：<code>ET_EXEC</code>。可以执行的一个程序，此文件规定了exec()如何创建一个程序的进程映像。</li>
<li>共享目标文件（Shared Object File）：<code>ET_DYN</code>。一般为<code>.so</code>文件。<ul>
<li>链接器将其与其他可重定位文件、共享目标文件链接成新的目标文件；</li>
<li>动态链接器（Dynamic Linker）将其与某个可执行文件或其他共享目标文件结合一个可执行文件，创建进程映像。</li>
</ul>
</li>
</ul>
<p><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/ELF/1.png" alt="img"></p>
<p>如图所示，为ELF文件的基本结构，主要由四部分组成：</p>
<ul>
<li>ELF Header</li>
<li>ELF Program Header Table（或称Program Headers、程序头）</li>
<li>ELF Section Header Table（或称Section Headers、节头表）</li>
<li>ELF Section</li>
</ul>
<p>从图中，就能看出它们各自的数据结构以及相互之间的索引关系。下面依次介绍。</p>
<p><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/ELF/2.png" alt="png"></p>
<p>段（<code>Segment</code>）与节（<code>Section</code>）的区别在于，段是程序执行的必要组成，当多个目标文件链接成一个可执行文件时，会将相同权限的节合并到一个段中。相比而言，节的粒度更小。</p>
<hr>
<h3 id="ELF-Header"><a href="#ELF-Header" class="headerlink" title="ELF Header"></a>ELF Header</h3><p>文件的最开始几个字节给出如何解释文件的提示信息。 这些信息独立于处理器， 也独立于文件中的其余内容。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EI_NIDENT 16</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span> e_ident[EI_NIDENT]; <span class="comment">//magic number</span></span><br><span class="line">	Elf32_Half e_type;                <span class="comment">//Ojbect file type</span></span><br><span class="line">	Elf32_Half e_machine;             <span class="comment">//Architecture</span></span><br><span class="line">	Elf32_Word e_version;             <span class="comment">//Object file version </span></span><br><span class="line">	Elf32_Addr e_entry;               <span class="comment">//entry point</span></span><br><span class="line">	Elf32_Off  e_phoff;               <span class="comment">//程序头内容在文件的偏移量</span></span><br><span class="line">	Elf32_off  e_shoff;               <span class="comment">//段头内容在文件的偏移量</span></span><br><span class="line">	Elf32_Word e_flags;</span><br><span class="line">	Elf32_Half e_ehsize;              <span class="comment">//elf头部大小</span></span><br><span class="line">	Elf32_Half e_phentsize;           <span class="comment">//程序头部表格的表项大小</span></span><br><span class="line">	Elf32_Half e_phnum;               <span class="comment">//程序头的个数Program header</span></span><br><span class="line">	Elf32_Half e_shentsize;           <span class="comment">//节区头部表格的表项大小</span></span><br><span class="line">	Elf32_Half e_shnum;               <span class="comment">//段头的个数Section header</span></span><br><span class="line">	Elf32_Half e_shstrndx;            <span class="comment">//String段在整个段列表中的索引值</span></span><br><span class="line">&#125;Elf32_Ehdr;</span><br></pre></td></tr></table></figure>

<h4 id="详细解释"><a href="#详细解释" class="headerlink" title="详细解释"></a>详细解释</h4><h5 id="e-ident"><a href="#e-ident" class="headerlink" title="e_ident"></a>e_ident</h5><p>数组给出了ELF的一些标识信息，这个数组中不同下标的含义如表所示：</p>
<p><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/ELF/3.png" alt="png"></p>
<p>这些索引访问包含以下数值的字节：</p>
<ul>
<li><p>EI_MAG0 到 EI_MAG3：<strong>魔数（Magic Number）</strong>，标志此文件是一个ELF目标文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">名称            取值         位置</span><br><span class="line">EI_MAG0        0x7f       e_ident[EI_MAG0]</span><br><span class="line">EI_MAG1        &#39;E&#39;        e_ident[EI_MAG1]</span><br><span class="line">EI_MAG2        &#39;L&#39;        e_ident[EI_MAG2]</span><br><span class="line">EI_MAG3        &#39;F&#39;        e_ident[EI_MAG3]</span><br></pre></td></tr></table></figure></li>
<li><p>EI_CLASS：标识文件的类别，或者说，容量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">名称             取值            位置</span><br><span class="line">ELFCLASSNONE     0            非法类别</span><br><span class="line">ELFCLASS32       1            32位目标</span><br><span class="line">ELFCLASS64       2            64位目标</span><br><span class="line">ps:ELFCLASS32支持虚存范围4GB，ELFCLASS64是为64位预留的，不过文件中的其他内容都没有针对64位定义</span><br></pre></td></tr></table></figure></li>
<li><p>EI_DATA：字节e_ident[EI_DATA] 给出处理器特定数据的数据编码方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">名称            取值              位置</span><br><span class="line">ELFDATANONE     0             非法数据编码</span><br><span class="line">ELFDATA2LSB     1             高位在前</span><br><span class="line">ELFDATA2MSB     2             低位在前</span><br></pre></td></tr></table></figure></li>
<li><p>EI_VERSION：ELF头部的版本号码，目前此值必须是EV_CURRENT。</p>
</li>
<li><p>EI_PAD：标记e_ident中未使用字节的开始，初始化为0。</p>
</li>
</ul>
<hr>
<h5 id="e-type"><a href="#e-type" class="headerlink" title="e_type"></a>e_type</h5><p>目标文件类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">名称            取值          含义</span><br><span class="line">ET_NONE         0         未知目标文件格式</span><br><span class="line">ET_REL          1         可重定位文件</span><br><span class="line">ET_EXEC         2         可执行文件</span><br><span class="line">ET_DYN          3         共享目标文件</span><br><span class="line">ET_CORE         4         Core文件（转储格式）</span><br><span class="line">ET_LOPROC     0xff00      特定处理器文件</span><br><span class="line">ET_HIPROC     0xffff      特定处理器文件</span><br><span class="line">ps:ET_LOPROC和ET_HIPROC之间的取值用来标识与处理器相关的文件格式</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="e-machine"><a href="#e-machine" class="headerlink" title="e_machine"></a>e_machine</h5><p>给出文件的目标体系结构类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">名称            取值          含义</span><br><span class="line">EM_NONE         0           未指定</span><br><span class="line">EM_M32          1           AT&amp;T WE 32100</span><br><span class="line">EM_SPARC        2           SPARC</span><br><span class="line">EM_386          3           Intel 80386</span><br><span class="line">EM_68K          4           Motorola 68000</span><br><span class="line">EM_88K          5           Motorola 88000</span><br><span class="line">EM_860          7           Intel 80860</span><br><span class="line">EM_MIPS         8           MIPS RS3000</span><br><span class="line">ps:其他值都是保留的。特定处理器的ELF名称会使用机器名来进行区分。</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="e-version"><a href="#e-version" class="headerlink" title="e_version"></a>e_version</h5><p>目标文件版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">名称            取值          含义</span><br><span class="line">  EV_NONE         0           非法版本</span><br><span class="line">  EV_CURRENT      1           当前版本</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="e-entry"><a href="#e-entry" class="headerlink" title="e_entry"></a>e_entry</h5><p>程序入口的虚拟地址，如果目标文件没有程序入口，可以为0</p>
<hr>
<h5 id="e-phoff"><a href="#e-phoff" class="headerlink" title="e_phoff"></a>e_phoff</h5><p>程序头部表格（Program Header Table）的偏移量（按字节计算）。如果文件没有程序头部表格，可以为0</p>
<hr>
<h5 id="e-shoff"><a href="#e-shoff" class="headerlink" title="e_shoff"></a>e_shoff</h5><p>节区头部表格（Section Header Table）的偏移量（按字节计算）。如果文件没有节区头部表格，可以为0</p>
<hr>
<h5 id="e-flags"><a href="#e-flags" class="headerlink" title="e_flags"></a>e_flags</h5><p>保存与文件相关的，特定于处理器的标志。标志名称采用EF_machine_flag的格式</p>
<hr>
<h5 id="e-ehsize"><a href="#e-ehsize" class="headerlink" title="e_ehsize"></a>e_ehsize</h5><p>ELF头部的大小（以字节计算）</p>
<hr>
<h5 id="e-phentsize"><a href="#e-phentsize" class="headerlink" title="e_phentsize"></a>e_phentsize</h5><p>程序头部表格的表项大小（按字节计算）</p>
<hr>
<h5 id="e-phnum"><a href="#e-phnum" class="headerlink" title="e_phnum"></a>e_phnum</h5><p>程序头部表格的表项数目。可以为0</p>
<hr>
<h5 id="e-shentsize"><a href="#e-shentsize" class="headerlink" title="e_shentsize"></a>e_shentsize</h5><p>节区头部表格的表项大小（按字节计算）</p>
<hr>
<h5 id="e-shnum"><a href="#e-shnum" class="headerlink" title="e_shnum"></a>e_shnum</h5><p>节区头部表格的表项数目。可以为0</p>
<hr>
<h5 id="e-shstrndx"><a href="#e-shstrndx" class="headerlink" title="e_shstrndx"></a>e_shstrndx</h5><p>节区头部表格中与节区名称字符串表相关的表项的索引。如果文件没有节区名称字符串表，此参数可以为SHN_UNDEF</p>
<h4 id="实例演示"><a href="#实例演示" class="headerlink" title="实例演示"></a>实例演示</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Linux ubuntu 5.4.0-55-generic #61-Ubuntu SMP Mon Nov 9 20:49:56 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line">ascotbe@ubuntu:~$ readelf -h /bin/sh</span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  Class:                             ELF64</span><br><span class="line">  Data:                              2<span class="string">&#x27;s complement, little endian</span></span><br><span class="line"><span class="string">  Version:                           1 (current)</span></span><br><span class="line"><span class="string">  OS/ABI:                            UNIX - System V</span></span><br><span class="line"><span class="string">  ABI Version:                       0</span></span><br><span class="line"><span class="string">  Type:                              DYN (Shared object file)</span></span><br><span class="line"><span class="string">  Machine:                           Advanced Micro Devices X86-64</span></span><br><span class="line"><span class="string">  Version:                           0x1</span></span><br><span class="line"><span class="string">  Entry point address:               0x5cd0</span></span><br><span class="line"><span class="string">  Start of program headers:          64 (bytes into file)</span></span><br><span class="line"><span class="string">  Start of section headers:          127896 (bytes into file)</span></span><br><span class="line"><span class="string">  Flags:                             0x0</span></span><br><span class="line"><span class="string">  Size of this header:               64 (bytes)</span></span><br><span class="line"><span class="string">  Size of program headers:           56 (bytes)</span></span><br><span class="line"><span class="string">  Number of program headers:         13</span></span><br><span class="line"><span class="string">  Size of section headers:           64 (bytes)</span></span><br><span class="line"><span class="string">  Number of section headers:         30</span></span><br><span class="line"><span class="string">  Section header string table index: 29</span></span><br></pre></td></tr></table></figure>

<p>ELF文件结构示意图中定义的<code>ELF_Endr</code>的各个成员的含义与readelf具有对应关系：</p>
<table>
<thead>
<tr>
<th>成员</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>e_ident</td>
<td>Magic: 7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00</td>
</tr>
<tr>
<td></td>
<td>class: ELF64</td>
</tr>
<tr>
<td></td>
<td>Data: 2’s complement, little endian</td>
</tr>
<tr>
<td></td>
<td>Version: 1 (current)</td>
</tr>
<tr>
<td></td>
<td>OS/ABI: UNIX - System V</td>
</tr>
<tr>
<td></td>
<td>ABI Version: 0</td>
</tr>
<tr>
<td>e_type</td>
<td>Type: DYN (Shared object file)</td>
</tr>
<tr>
<td></td>
<td>共享目标文件</td>
</tr>
<tr>
<td>e_machine</td>
<td>Advanced Micro Devices X86-64</td>
</tr>
<tr>
<td></td>
<td>ELF文件的CPI平台属性</td>
</tr>
<tr>
<td>e_version</td>
<td>Version: 0x1</td>
</tr>
<tr>
<td></td>
<td>ELF版本号。一般为常数1</td>
</tr>
<tr>
<td>e_entry</td>
<td>Entry point address: 0x5cd0</td>
</tr>
<tr>
<td></td>
<td>入口地址，规定ELF程序的入口虚拟地址，操作系统在加载完该程序后从这个地址开始执行进程的指令。</td>
</tr>
<tr>
<td>e_phoff</td>
<td>Start of program headers: 64 (bytes into file)</td>
</tr>
<tr>
<td>e_shoff</td>
<td>Start of section headers: 127896 (bytes into file)</td>
</tr>
<tr>
<td></td>
<td>Section Header Table 在文件中的偏移</td>
</tr>
<tr>
<td>e_word</td>
<td>Flags: 0x0</td>
</tr>
<tr>
<td></td>
<td>ELF标志位，用来标识一些ELF文件平台相关的属性</td>
</tr>
<tr>
<td>e_ehsize</td>
<td>Size of this header: 64(bytes)</td>
</tr>
<tr>
<td></td>
<td>ELF Header本身的大小</td>
</tr>
<tr>
<td>e_phentsize</td>
<td>Size of program headers:56 (bytes)</td>
</tr>
<tr>
<td>e_phnum</td>
<td>Number of program headers: 13</td>
</tr>
<tr>
<td>e_shentsize</td>
<td>Size of section headers: 64 (bytes)</td>
</tr>
<tr>
<td></td>
<td>单个Section Header大小</td>
</tr>
<tr>
<td>e_shnum</td>
<td>Number of section headers: 30</td>
</tr>
<tr>
<td></td>
<td>Section Header的数量</td>
</tr>
<tr>
<td>e_shstrndx</td>
<td>Section header string table index: 29</td>
</tr>
<tr>
<td></td>
<td>Section Header字符串在Section Header Table中的索引</td>
</tr>
</tbody></table>
<h3 id="ELF-Section-Header-Table"><a href="#ELF-Section-Header-Table" class="headerlink" title="ELF Section Header Table"></a>ELF Section Header Table</h3><p>ELF节头表是一个节头数组。每一个节头都描述了其所对应的节的信息，如节名、节大小、在文件中的偏移、读写权限等。<strong>编译器、链接器、装载器都是通过节头表来定位和访问各个节的属性的。</strong></p>
<p><code>e_shoff</code>成员给出从文件头到节区头部表格的偏移字节数；<code>e_shnum</code>给出表格中条目数目；<code>e_shentsize</code>给出每个项目的字节数。从这些信息中可以确切地定位节区的具体位置、长度。</p>
<p>节区头部表格中比较特殊的几个小标如下：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>取值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>SHN_UNDEF</td>
<td>0</td>
<td>标记未定义的、缺失的、不相关的，或者没有含义的节区引用</td>
</tr>
<tr>
<td>SHN_LORESERVE</td>
<td>0xFF00</td>
<td>保留索引的下界</td>
</tr>
<tr>
<td>SHN_LOPROC</td>
<td>0xFF00</td>
<td>保留给处理器特殊的语义</td>
</tr>
<tr>
<td>SHN_HIPROC</td>
<td>0xFF1F</td>
<td>保留给处理器特殊的语义</td>
</tr>
<tr>
<td>SHN_ABS</td>
<td>0xFFF1</td>
<td>包含对应引用量的绝对取值。这些值不会被重定位所影响</td>
</tr>
<tr>
<td>SHN_COMMON</td>
<td>0xFFF2</td>
<td>相对于此节区定义的符号是公共符号。如FORTRAN中COMMON或者未分配的C外部变量</td>
</tr>
<tr>
<td>SHN_HIRESERVE</td>
<td>0xFFFF</td>
<td>保留索引的上界</td>
</tr>
</tbody></table>
<p>介于<code>SHN_LORESERVE</code>和<code>SHN_HIRESERVE</code>之间的表项不会出现在节区头部表中。</p>
<p>每个节区头部可用如下数据结构描述:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf32_Word sh_name;      <span class="comment">//给出节区名称。是节区头部字符串节区（Section Header String Table Section）的索引。名字是一个NULL结尾的字符串，保存在一个名为.shstrtab的字符串表（可通过Section Header索引到）</span></span><br><span class="line">    Elf32_Word sh_type;      <span class="comment">//节类型。为节区的内容和语义进行分类。</span></span><br><span class="line">    Elf32_Word sh_flags;     <span class="comment">//节标志位。节区支持1位形式的标志，这些标志描述了多种属性</span></span><br><span class="line">    Elf32_Addr sh_addr;      <span class="comment">//节的虚拟地址。如果节区将出现在进程的内存映像中或可被加载，则sh_addr为该节被加载后在进程地址空间中的虚拟地址，给出节区的每一个字节应处的位置。否则，此字段为0</span></span><br><span class="line">    Elf32_Off sh_offset;     <span class="comment">//节偏移。如果该节存在于文件中，则该节表示在文件中的偏移；否则无意义，如sh_offset对于BSS节来说就是没有意义的。即此成员的取值给出节区的第一个字节与文件头之间的偏移。</span></span><br><span class="line">    Elf32_Word sh_size;      <span class="comment">//节大小。此成员给出节区的长度（字节数）。除非节区的类型是SHT_NOBITS，否则节区占用文件中的sh_size字节。</span></span><br><span class="line">    Elf32_Word sh_link;      <span class="comment">//节链接信息。此成员给出节区头部表索引链接，其解释依赖于节区类型</span></span><br><span class="line">    Elf32_Word sh_info;      <span class="comment">//节链接信息。此成员给出附加信息，其解释依赖于节区类型</span></span><br><span class="line">    Elf32_Word sh_addralign; <span class="comment">//节地址对齐方式。某些节区带有地址对齐约束。</span></span><br><span class="line">    Elf32_Word sh_entsize;   <span class="comment">//节项大小。某些节区中包含固定大小的项目，如符号表，其包含的每个符号所在的大小都一样。</span></span><br><span class="line">&#125; Elf32_Shdr;</span><br></pre></td></tr></table></figure>

<p><strong>注意：索引为零（SHN_UNDFF）的节区头部也是存在的，尽管此索引标记的是未定义的节区引用，并且节区的内容固定</strong></p>
<p><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/ELF/4.png" alt="png"></p>
<h4 id="部分字段解析"><a href="#部分字段解析" class="headerlink" title="部分字段解析"></a>部分字段解析</h4><h5 id="sh-type"><a href="#sh-type" class="headerlink" title="sh_type"></a>sh_type</h5><p>节名是一个字符串，只是在链接和编译过程中有意义，但它不能真正地表示节的类型。对于编译器和链接器来说，主要决定节的属性是节的类型（<code>sh_type</code>）和节的标志位（<code>sh_flags</code>）</p>
<p>节的类型相关常量以<code>SHT_</code>开头，上述<code>readelf -S</code>命令执行的结果省略了该前缀。节区类型定义如表：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>取值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>SHT_NULL</td>
<td>0</td>
<td>此值标志节区头部是非活动的，没有对应的节区。（无效节）</td>
</tr>
<tr>
<td>SHT_PROGBITS</td>
<td>1</td>
<td><strong>程序节</strong>。此节区包含程序定义的信息，其格式和含义都有程序来解释，代码节、数据节都是这种类型</td>
</tr>
<tr>
<td>SHT_SYMTAB</td>
<td>2</td>
<td>此节区包含一个<strong>符号表</strong>。目前目标文件对每种类型的节区都只能包含一个，不过这个限制将来可能会发生变化。一般，SHT_SYMTAB节区提供用于链接编辑（指ld而言）的符号，尽管也可用来实现动态链接</td>
</tr>
<tr>
<td>SHT_STRTAB</td>
<td>3</td>
<td>此节区包含<strong>字符串表</strong>。目标文件可能包含多个字符串表节区</td>
</tr>
<tr>
<td>SHT_RELA</td>
<td>4</td>
<td>此节区包含<strong>重定位表项</strong>，其中可能会有补齐内容（addend），例如32位目标文件中的Elf32_Rela类型。目标文件可能拥有多个重定位节区</td>
</tr>
<tr>
<td>SHT_HASH</td>
<td>5</td>
<td>此节区包含<strong>符号哈希表</strong>。所有参与动态链接的目标都必须包含一个符号哈希表。目前，一个目标文件只能包含一个哈希表，不过此限制将来可能会解除</td>
</tr>
<tr>
<td>SHT_DYNAMIC</td>
<td>6</td>
<td>此节区包含动态链接的信息。目前一个目标文件中只能包含一个动态节区，将来可能会取消这一限制</td>
</tr>
<tr>
<td>SHT_NOTE</td>
<td>7</td>
<td>此节区包含以某种方式来标记文件的信息，即提示信息</td>
</tr>
<tr>
<td>SHT_NOBITS</td>
<td>8</td>
<td>表示该节在文件中没有内容，如<code>.bss</code>节。这种类型的节区不占用文件中的空间，其他方面和<code>SHT_PROGBITS</code>相似。尽管此节区不包含任何字节，成员<code>sh_offset</code>中还是会包含概念性的文件偏移</td>
</tr>
<tr>
<td>SHT_REL</td>
<td>9</td>
<td>此节区包含重定位表项，其中没有补齐（addends），例如32位目标文件中的Elf32_rel类型。目标文件中可以拥有多个重定位节区</td>
</tr>
<tr>
<td>SHT_SHLIB</td>
<td>10</td>
<td>此节区被保留，不过其语义是未规定的。包含此类型节区的程序与ABI不兼容</td>
</tr>
<tr>
<td>SHT_DYNSYM</td>
<td>11</td>
<td><strong>动态链接的符号表</strong>。作为一个完整的符号表，它可能包含很多对动态链接而言不必要的符号。因此，目标文件也可以包含一个SHT_DYNSYM节区，其中保存动态链接符号的一个最小集合，以节省空间</td>
</tr>
<tr>
<td>SHT_LOPROC</td>
<td>0x70000000</td>
<td>这一段（包含两个边界），是保留给处理器专用语义的</td>
</tr>
<tr>
<td>SHT_HIPROC</td>
<td>0x7FFFFFFF</td>
<td>这一段（包含两个边界），是保留给处理器专用语义的</td>
</tr>
<tr>
<td>SHT_LOUSER</td>
<td>0x80000000</td>
<td>此值给出保留给应用程序的索引下界</td>
</tr>
<tr>
<td>SHT_HIUSER</td>
<td>0x8FFFFFFF</td>
<td>此值给出保留给应用程序的索引上界</td>
</tr>
</tbody></table>
<hr>
<h5 id="sh-flags"><a href="#sh-flags" class="headerlink" title="sh_flags"></a>sh_flags</h5><p>sh_flags字段定义了一个节区中包含的内容是否可以修改、是否可以执行等消息。如果一个标志位被设置，则该位取值为1。未定义的各位都设置为0。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>取值</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>SHF_WRITE</td>
<td>0x1</td>
<td>表示该节在进程空间中可写</td>
</tr>
<tr>
<td>SHF_ALLOC</td>
<td>0x2</td>
<td>表示该节在进程空间中需要分配空间。有些包含指示或控制信息的节不需要在进程空间中分配空间，就不会有这个标志。</td>
</tr>
<tr>
<td>SHF_EXECINSTR</td>
<td>0x4</td>
<td>表示该节在进程空间中可以被执行</td>
</tr>
<tr>
<td>SHF_MASKPROC</td>
<td>0xF0000000</td>
<td></td>
</tr>
</tbody></table>
<p>其中已经定义了的各位含义如下：</p>
<ul>
<li>SHF_WRITE：节区包含进程执行过程中将可写的数据</li>
<li>SHF_ALLOC：此节区在进程执行中占用内存。某些控制节区并不出现于目标文件的内存映像中，对于那些节区，此位应设置为0</li>
<li>SHF_EXECINSTR：节区包含可执行的机器指令</li>
<li>SHF_MASKPROC：所有包含于此掩码中的四位都用于处理器专用的语义</li>
</ul>
<hr>
<h5 id="sh-link和sh-info"><a href="#sh-link和sh-info" class="headerlink" title="sh_link和sh_info"></a>sh_link和sh_info</h5><p>如果节的类型是与链接有关的（无论是动态链接还是静态链接），如<strong>重定位表、符号表</strong>等，则<code>sh_link</code>、<code>sh_info</code>两个成员所包含的意义如下所示。其它类型的节中这两个成员没有意义。</p>
<p>根据节区类型的不同，sh_link和sh_info的具体含义也有所不同：</p>
<p><img src="http://cdn.peckerwood.top/3-4-1.png" alt="png"></p>
<hr>
<h3 id="ELF-Sections"><a href="#ELF-Sections" class="headerlink" title="ELF Sections"></a>ELF Sections</h3><h4 id="节的分类"><a href="#节的分类" class="headerlink" title="节的分类"></a>节的分类</h4><p><strong>.text</strong></p>
<p><code>.text</code>节是保存了程序代码指令的代码节。一段可执行程序，如果存在Phdr，则<code>.text</code>节就会存在于<code>text</code>段中。由于<code>.text</code>节保存了程序代码，所以节类型为<code>SHT_PROGBITS</code>。</p>
<p><strong>.rodata</strong></p>
<p><code>.rodata</code>节保存了只读的数据，如一行c语言代码中的字符串。由于<code>.rodata</code>节是只读的，所以只能存在于一个可执行文件的<strong>只读段</strong>中。因此，只能在<code>text</code>段（而不是<code>data</code>段）中找到<code>.rodata</code>节。由于<code>.rodata</code>节是只读的，所以节类型为<code>SHT_PROGBITS</code>。</p>
<p><strong>.plt</strong></p>
<p><code>.plt</code>节也称为<strong>过程链接表（Procedure Linkage Table）</strong>，其包含了动态链接器调用从共享库导入的函数所必需的相关代码。由于<code>.plt</code>节保存了代码，所以节类型为<code>SHT_PROGBITS</code>。</p>
<p><strong>.data</strong></p>
<p><code>.data</code>节存在于<code>data</code>段中，<strong>其保存了初始化的全局变量等数据</strong>。由于<code>.data</code>节保存了程序的变量数据，所以节类型为<code>SHT_PROGBITS</code>。</p>
<p><strong>.bss</strong></p>
<p><code>.bss</code>节存在于<code>data</code>段中，占用空间不超过4字节，仅表示这个节本来的空间。<code>.bss</code>节保存了未进行初始化的全局数据。程序加载时数据被初始化为0，在程序执行期间可以进行赋值。由于<code>.bss</code>节未保存实际的数据，所以节类型为<code>SHT_NOBITS</code>。</p>
<p><strong>.got.plt</strong></p>
<p><code>.got</code>节保存了全局偏移量。<code>.got</code>节和<code>.plt</code>节一起提供了对导入的共享库函数的访问入口，由动态链接器在运行时进行修改。由于<code>.got .plt</code>节与程序执行有关，所以节类型为<code>SHT_PROGBITS</code>。</p>
<p><strong>.dynsym</strong></p>
<p><code>.dynsym</code>节保存在<code>text</code>段中。其保存了从共享库导入的动态符号表。节类型为<code>SHT_DYNSYM</code>。</p>
<p><strong>.dynstr</strong></p>
<p><code>.dynstr</code>保存了动态链接字符串表，表中存放了一系列字符串，这些字符串代表了符号名称，以空字符作为终止符。</p>
<p><strong>.rel.name .relaname</strong></p>
<p>name根据重定位所适用的节区给定。例如<code>.text</code>节区的重定位节区名字将是：<code>.rel.text</code>或者<code>.rela.text</code>。重定位表保存了重定位相关的信息，这些信息描述了如何在链接或运行时，对ELF目标文件的某些部分或者进程镜像进行补充或者修改。由于重定位表保存了重定位相关的数据，所以节类型为<code>SHT_REL</code>。</p>
<p><strong>.hash</strong></p>
<p><code>.hash</code>节也称为<code>.gnu.hash</code>，其保存了一个用于查找符号的散列表。</p>
<p><strong>.symtab</strong></p>
<p><code>.symtab</code>节是一个<code>ElfN_Sym</code>的数组，保存了符号信息。节类型为<code>SHT_SYMTAB</code>。</p>
<p><strong>.strtab</strong></p>
<p><code>.strtab</code>节保存的是符号字符串表，表中的内容会被<code>.symtab</code>的<code>ElfN_Sym</code>结构中的<code>st_name</code>引用。节类型为<code>SHT_STRTAB</code>。</p>
<p><strong>.ctors&amp;.dtors</strong></p>
<p><code>ctors</code>（构造器）节和<code>.dtors</code>（析构器）节分别保存了指向构造函数和析构函数的函数指针，构造函数是在main函数执行之前需要执行的代码；析构函数是在main函数之后需要执行的代码。</p>
<p>我们可以使用readelf工具来查看节头表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">ascotbe@ubuntu:~$ readelf -S /bin/sh</span><br><span class="line">There are 30 section headers, starting at offset 0x1f398:</span><br><span class="line"></span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type             Address           Offset</span><br><span class="line">       Size              EntSize          Flags  Link  Info  Align</span><br><span class="line">  [ 0]                   NULL             0000000000000000  00000000</span><br><span class="line">       0000000000000000  0000000000000000           0     0     0</span><br><span class="line">  [ 1] .interp           PROGBITS         0000000000000318  00000318</span><br><span class="line">       000000000000001c  0000000000000000   A       0     0     1</span><br><span class="line">  [ 2] .note.gnu.propert NOTE             0000000000000338  00000338</span><br><span class="line">       0000000000000020  0000000000000000   A       0     0     8</span><br><span class="line">  [ 3] .note.gnu.build-i NOTE             0000000000000358  00000358</span><br><span class="line">       0000000000000024  0000000000000000   A       0     0     4</span><br><span class="line">  [ 4] .note.ABI-tag     NOTE             000000000000037c  0000037c</span><br><span class="line">       0000000000000020  0000000000000000   A       0     0     4</span><br><span class="line">  [ 5] .gnu.hash         GNU_HASH         00000000000003a0  000003a0</span><br><span class="line">       00000000000002d8  0000000000000000   A       6     0     8</span><br><span class="line">  [ 6] .dynsym           DYNSYM           0000000000000678  00000678</span><br><span class="line">       0000000000001158  0000000000000018   A       7     1     8</span><br><span class="line">  [ 7] .dynstr           STRTAB           00000000000017d0  000017d0</span><br><span class="line">       00000000000006b6  0000000000000000   A       0     0     1</span><br><span class="line">  [ 8] .gnu.version      VERSYM           0000000000001e86  00001e86</span><br><span class="line">       0000000000000172  0000000000000002   A       6     0     2</span><br><span class="line">  [ 9] .gnu.version_r    VERNEED          0000000000001ff8  00001ff8</span><br><span class="line">       0000000000000070  0000000000000000   A       7     1     8</span><br><span class="line">  [10] .rela.dyn         RELA             0000000000002068  00002068</span><br><span class="line">       0000000000001b00  0000000000000018   A       6     0     8</span><br><span class="line">  [11] .rela.plt         RELA             0000000000003b68  00003b68</span><br><span class="line">       00000000000007f8  0000000000000018  AI       6    25     8</span><br><span class="line">  [12] .init             PROGBITS         0000000000005000  00005000</span><br><span class="line">       000000000000001b  0000000000000000  AX       0     0     4</span><br><span class="line">  [13] .plt              PROGBITS         0000000000005020  00005020</span><br><span class="line">       0000000000000560  0000000000000010  AX       0     0     16</span><br><span class="line">  [14] .plt.got          PROGBITS         0000000000005580  00005580</span><br><span class="line">       0000000000000020  0000000000000010  AX       0     0     16</span><br><span class="line">  [15] .plt.sec          PROGBITS         00000000000055a0  000055a0</span><br><span class="line">       0000000000000550  0000000000000010  AX       0     0     16</span><br><span class="line">  [16] .text             PROGBITS         0000000000005af0  00005af0</span><br><span class="line">       0000000000011cf5  0000000000000000  AX       0     0     16</span><br><span class="line">  [17] .fini             PROGBITS         00000000000177e8  000177e8</span><br><span class="line">       000000000000000d  0000000000000000  AX       0     0     4</span><br><span class="line">  [18] .rodata           PROGBITS         0000000000018000  00018000</span><br><span class="line">       0000000000001f42  0000000000000000   A       0     0     32</span><br><span class="line">  [19] .eh_frame_hdr     PROGBITS         0000000000019f44  00019f44</span><br><span class="line">       0000000000000804  0000000000000000   A       0     0     4</span><br><span class="line">  [20] .eh_frame         PROGBITS         000000000001a748  0001a748</span><br><span class="line">       00000000000031a8  0000000000000000   A       0     0     8</span><br><span class="line">  [21] .init_array       INIT_ARRAY       000000000001ef30  0001df30</span><br><span class="line">       0000000000000008  0000000000000008  WA       0     0     8</span><br><span class="line">  [22] .fini_array       FINI_ARRAY       000000000001ef38  0001df38</span><br><span class="line">       0000000000000008  0000000000000008  WA       0     0     8</span><br><span class="line">  [23] .data.rel.ro      PROGBITS         000000000001ef40  0001df40</span><br><span class="line">       0000000000000bc8  0000000000000000  WA       0     0     32</span><br><span class="line">  [24] .dynamic          DYNAMIC          000000000001fb08  0001eb08</span><br><span class="line">       00000000000001f0  0000000000000010  WA       7     0     8</span><br><span class="line">  [25] .got              PROGBITS         000000000001fcf8  0001ecf8</span><br><span class="line">       00000000000002f0  0000000000000008  WA       0     0     8</span><br><span class="line">  [26] .data             PROGBITS         0000000000020000  0001f000</span><br><span class="line">       0000000000000240  0000000000000000  WA       0     0     32</span><br><span class="line">  [27] .bss              NOBITS           0000000000020240  0001f240</span><br><span class="line">       0000000000002c30  0000000000000000  WA       0     0     32</span><br><span class="line">  [28] .gnu_debuglink    PROGBITS         0000000000000000  0001f240</span><br><span class="line">       0000000000000034  0000000000000000           0     0     4</span><br><span class="line">  [29] .shstrtab         STRTAB           0000000000000000  0001f274</span><br><span class="line">       000000000000011d  0000000000000000           0     0     1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),</span><br><span class="line">  L (link order), O (extra OS processing required), G (group), T (TLS),</span><br><span class="line">  C (compressed), x (unknown), o (OS specific), E (exclude),</span><br><span class="line">  l (large), p (processor specific)</span><br></pre></td></tr></table></figure>

<h4 id="符号表"><a href="#符号表" class="headerlink" title="符号表"></a>符号表</h4><p>节的分类中我们介绍了<code>.dynsym</code>节和<code>.symtab</code>节，两者都是符号表。那么它们到底有什么区别呢？存在什么关系呢？</p>
<p><strong>符号是对某些类型的数据或代码（如全局变量或函数）的符号引用，函数名或变量名就是符号名</strong>。例如，<code>printf()</code>函数会在动态链接符号表<code>.dynsym</code>中存有一个指向该函数的符号项（以<code>Elf_Sym</code>数据结构表示）。在大多数共享库和动态链接可执行文件中，存在两个符号表。即<code>.dynsym</code>和<code>.symtab</code>。</p>
<p><strong><code>.dynsym</code>保存了引用来自外部文件符号的全局符号</strong>。如<code>printf</code>库函数。**<code>.dynsym</code>保存的符号是<code>.symtab</code>所保存符合的子集，<code>.symtab</code>中还保存了可执行文件的本地符号**。如全局变量，代码中定义的本地函数等。</p>
<p>既然<code>.dynsym</code>是<code>.symtab</code>的子集，那为何要同时存在两个符号表呢？</p>
<p>通过<code>readelf -S</code>命令可以查看可执行文件的输出，一部分节标志位（<code>sh_flags</code>）被标记为了<strong>A（ALLOC）、WA（WRITE/ALLOC）、AX（ALLOC/EXEC）</strong>。其中，<code>.dynsym</code>被标记为ALLOC，而<code>.symtab</code>则没有标记。</p>
<p>ALLOC表示有该标记的节会在运行时分配并装载进入内存，而<code>.symtab</code>不是在运行时必需的，因此不会被装载到内存中。**<code>.dynsym</code>保存的符号只能在运行时被解析，因此是运行时动态链接器所需的唯一符号**。<code>.dynsym</code>对于动态链接可执行文件的执行是必需的，而<code>.symtab</code>只是用来进行调试和链接的。</p>
<p><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/ELF/5.png" alt="img"></p>
<p>上图所示为通过符号表索引字符串表的示意图。符号表中的每一项都是一个<code>Elf_Sym</code>结构，对应可以在字符串表中索引得到一个字符串。该数据结构符号表项的格式如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf32_Word st_name;     <span class="comment">//符号名。该值为该符号名在字符串表中的偏移地址。</span></span><br><span class="line">    Elf32_Addr st_value;    <span class="comment">//符号对应的值。存放符号的值（可能是地址或位置偏移量）。</span></span><br><span class="line">    Elf32_Word st_size;     <span class="comment">//符号的大小。</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> st_info;  <span class="comment">//此成员给出符号的类型和绑定属性。下面给出若干取值和含义的绑定关系</span></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> st_other; <span class="comment">//符号所在的节</span></span><br><span class="line">    Elf32_Half st_shndx;    <span class="comment">//符号类型及绑定属性</span></span><br><span class="line">&#125; Elf32_sym;</span><br></pre></td></tr></table></figure>

<h4 id="字符串表"><a href="#字符串表" class="headerlink" title="字符串表"></a>字符串表</h4><p>类似于符号表，在大多数共享库和动态链接可执行文件中，也存在两个字符串表。即<code>.dynstr</code>和<code>.strtab</code>，分别对应于<code>.dynsym</code>和<code>symtab</code>。此外，还有一个<code>.shstrtab</code>的节头字符串表，用于保存节头表中用到的字符串，可通过<code>sh_name</code>进行索引。</p>
<p>ELF文件中所有字符表的结构基本一致，如上图所示。</p>
<h4 id="重定位表"><a href="#重定位表" class="headerlink" title="重定位表"></a>重定位表</h4><p><strong>重定位就是将符号定义和符号引用进行连接的过程</strong>。可重定位文件需要包含描述如何修改节内容的相关信息，从而使可执行文件和共享目标文件能够保存进程的程序镜像所需要的正确信息。</p>
<p>重定位表是进行重定位的重要依据。我们可以使用objdump工具查看目标文件的重定位表：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf32_Addr r_offset;  <span class="comment">//重定位入口的偏移。</span></span><br><span class="line">                          <span class="comment">//对于可重定位文件来说，这个值是该重定位入口所要修正的位置的第一个字节相对于节起始的偏移</span></span><br><span class="line">                          <span class="comment">//对于可执行文件或共享对象文件来说，这个值是该重定位入口所要修正的位置的第一个字节的虚拟地址</span></span><br><span class="line">    Elf32_word r_info;    <span class="comment">//重定位入口的类型和符号</span></span><br><span class="line">                          <span class="comment">//对于可执行文件和共享目标文件来说，它们的重定位入口是动态链接类型的。</span></span><br><span class="line">&#125; Elf32_Rel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Elf32_Addr r_offset;</span><br><span class="line">    Elf32_Word r_info;</span><br><span class="line">    Elf32_Word r_addend;  <span class="comment">//此成员给出一个常量补齐，用来计算将被填充到可重定位字段的数值。</span></span><br><span class="line">&#125; Elf32_Rela;</span><br></pre></td></tr></table></figure>

<blockquote>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.chuquan.me&#x2F;2018&#x2F;05&#x2F;21&#x2F;elf-introduce&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;paper.seebug.org&#x2F;papers&#x2F;Archive&#x2F;refs&#x2F;elf&#x2F;Understanding_ELF.pdf</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">ascotbe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.ascotbe.com/2020/12/06/ExecutableLinkableFormat/">https://www.ascotbe.com/2020/12/06/ExecutableLinkableFormat/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.ascotbe.com" target="_blank">ascotbe</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/119.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/" target="_blank"><img class="post-qr-code-img" src="/"/></a><div class="post-qr-code-desc"></div></li><li class="reward-item"><a href="/" target="_blank"><img class="post-qr-code-img" src="/"/></a><div class="post-qr-code-desc"></div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/08/CrossSiteScripting/"><img class="prev-cover" src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/120.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">从零开始编写XSS平台</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/20/StackOverflow_Linux_0x02/"><img class="next-cover" src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/118.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Linux栈溢出总结（0x02）</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">ascotbe</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">62</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ascotbe"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:ascotbe@gmail.com" target="_blank" title=""><i class="fa fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">所有文章都是本人学习笔记仅限交流探讨，禁止利用文章思路进行违法操作，如有违规和作者无关！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E7%BB%93%E6%9E%84%E5%8C%BA%E5%88%86"><span class="toc-number">2.</span> <span class="toc-text">常见结构区分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ELF"><span class="toc-number">3.</span> <span class="toc-text">ELF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text">文件格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ELF-Header"><span class="toc-number">3.2.</span> <span class="toc-text">ELF Header</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A"><span class="toc-number">3.2.1.</span> <span class="toc-text">详细解释</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#e-ident"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">e_ident</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-type"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">e_type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-machine"><span class="toc-number">3.2.1.3.</span> <span class="toc-text">e_machine</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-version"><span class="toc-number">3.2.1.4.</span> <span class="toc-text">e_version</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-entry"><span class="toc-number">3.2.1.5.</span> <span class="toc-text">e_entry</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-phoff"><span class="toc-number">3.2.1.6.</span> <span class="toc-text">e_phoff</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-shoff"><span class="toc-number">3.2.1.7.</span> <span class="toc-text">e_shoff</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-flags"><span class="toc-number">3.2.1.8.</span> <span class="toc-text">e_flags</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-ehsize"><span class="toc-number">3.2.1.9.</span> <span class="toc-text">e_ehsize</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-phentsize"><span class="toc-number">3.2.1.10.</span> <span class="toc-text">e_phentsize</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-phnum"><span class="toc-number">3.2.1.11.</span> <span class="toc-text">e_phnum</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-shentsize"><span class="toc-number">3.2.1.12.</span> <span class="toc-text">e_shentsize</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-shnum"><span class="toc-number">3.2.1.13.</span> <span class="toc-text">e_shnum</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#e-shstrndx"><span class="toc-number">3.2.1.14.</span> <span class="toc-text">e_shstrndx</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA"><span class="toc-number">3.2.2.</span> <span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ELF-Section-Header-Table"><span class="toc-number">3.3.</span> <span class="toc-text">ELF Section Header Table</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E5%AD%97%E6%AE%B5%E8%A7%A3%E6%9E%90"><span class="toc-number">3.3.1.</span> <span class="toc-text">部分字段解析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#sh-type"><span class="toc-number">3.3.1.1.</span> <span class="toc-text">sh_type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sh-flags"><span class="toc-number">3.3.1.2.</span> <span class="toc-text">sh_flags</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sh-link%E5%92%8Csh-info"><span class="toc-number">3.3.1.3.</span> <span class="toc-text">sh_link和sh_info</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ELF-Sections"><span class="toc-number">3.4.</span> <span class="toc-text">ELF Sections</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">3.4.1.</span> <span class="toc-text">节的分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="toc-number">3.4.2.</span> <span class="toc-text">符号表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8"><span class="toc-number">3.4.3.</span> <span class="toc-text">字符串表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E4%BD%8D%E8%A1%A8"><span class="toc-number">3.4.4.</span> <span class="toc-text">重定位表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0"><span class="toc-number">4.</span> <span class="toc-text">参考文章</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/08/17/Office_0x02/" title="关于邮件钓鱼的哪些事(二)"><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/131.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于邮件钓鱼的哪些事(二)"/></a><div class="content"><a class="title" href="/2021/08/17/Office_0x02/" title="关于邮件钓鱼的哪些事(二)">关于邮件钓鱼的哪些事(二)</a><time datetime="2021-08-17T13:45:42.000Z" title="发表于 2021-08-17 21:45:42">2021-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/11/BlueArmyTips/" title="一些蓝军小技巧"><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/130.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一些蓝军小技巧"/></a><div class="content"><a class="title" href="/2021/08/11/BlueArmyTips/" title="一些蓝军小技巧">一些蓝军小技巧</a><time datetime="2021-08-11T15:07:46.000Z" title="发表于 2021-08-11 23:07:46">2021-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/12/RedisWritesShell/" title="Redis写SHELL"><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/129.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis写SHELL"/></a><div class="content"><a class="title" href="/2021/07/12/RedisWritesShell/" title="Redis写SHELL">Redis写SHELL</a><time datetime="2021-07-12T15:07:46.000Z" title="发表于 2021-07-12 23:07:46">2021-07-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/07/09/FrequentToolCharacteristics/" title="常见工具特征去除"><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/128.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常见工具特征去除"/></a><div class="content"><a class="title" href="/2021/07/09/FrequentToolCharacteristics/" title="常见工具特征去除">常见工具特征去除</a><time datetime="2021-07-09T15:07:46.000Z" title="发表于 2021-07-09 23:07:46">2021-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/06/09/WindowsGrabPassword/" title="Windows本地密码抓取"><img src="https://raw.staticdn.net/Ascotbe/Random-img/master/BlogCover/127.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows本地密码抓取"/></a><div class="content"><a class="title" href="/2021/06/09/WindowsGrabPassword/" title="Windows本地密码抓取">Windows本地密码抓取</a><time datetime="2021-06-09T15:45:42.000Z" title="发表于 2021-06-09 23:45:42">2021-06-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2021 By ascotbe</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'Ascotbe/Ascotbe.github.io')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme () {
  if (document.querySelector('.utterances-frame')) {
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    const iframe = document.querySelector('.utterances-frame');
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

if ('Utterances' === 'Utterances' || !true) {
  if (true) btf.loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/Bronya.model.json"},"display":{"position":"right","width":400,"height":500,"hOffset":-90,"vOffset":0},"mobile":{"show":false},"log":false});</script></body></html>